!function(e){"use strict";e.module("alt.koopon.selecao-empresa",["ngResource","alt.passaporte-usuario-logado","alt.alerta-flutuante"]).provider("AltKoopon_BASE_API",function(){this.url="/koopon-rest-api/",this.$get=function(){return this.url}}).factory("AltKooponEmpresaResource",["$resource","AltKoopon_BASE_API",function(e,o){var r=o+"assinantes/selecao",a={},t={escolhe:{method:"POST",isArray:!1}};return e(r,a,t)}]).factory("AltKooponEmpresaService",["$q","$xtorage","AltPassaporteUsuarioLogadoManager","AltKooponEmpresaResource",function(e,o,r,a){var t="emp_escolhida",s=function(){};return s.prototype.getEmpresas=function(){return r.retorna().assinantes},s.prototype.salvaNaStorageEmpresaEscolhida=function(e){o.save(t,e)},s.prototype.getEmpresaEscolhidaDaStorage=function(){return o.get(t)},s.prototype.escolhe=function(o){return angular.isUndefined(o)||!angular.isObject(o)||angular.isUndefined(o.id)?e.reject(new TypeError("Empresa deve ser informada para ser passada ao servidor.")):a.escolhe({empresaEscolhida:o.id}).$promise.then(function(e){return e})["catch"](function(o){return e.reject(o)})},new s}]).controller("AltKooponSelecaoEmpresasController",["$location","AltKooponEmpresaService","AltAlertaFlutuanteService",function(e,o,r){var a=this;a.empresas=[],a._escolheEmpresa=function(a){o.escolhe(a).then(function(){e.path("/"),o.salvaNaStorageEmpresaEscolhida(a)})["catch"](function(e){r.exibe({msg:e.mensagem})})},a.escolheEmpresa=function(e){a._escolheEmpresa(e)},function(){a.empresas=o.getEmpresas()||a.empresas,1===a.empresas.length&&a._escolheEmpresa(a.empresas[0])}()}])}(window.angular);